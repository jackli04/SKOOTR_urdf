<?xml version="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro" name="skootr_legs">

  <!-- Properties definition -->
  <xacro:property name="mesh_pkg" value="skootr_description"/>

  <xacro:macro name="leg" params="prefix parent_link">

  <!-- link2 -->
    <link name="${prefix}_link2_p1">
      <visual>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/link2p1.stl"
                scale="1 1 1"/>
        </geometry>
        <material name="${prefix}_link2_p1_blue">
          <color rgba="0.231 0.380 0.706 1.0"/>
        </material>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/link2p1.stl"
                scale="1 1 1"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="-0.0621 2.54e-5 0.003429" rpy="0 0 0"/>
        <mass value="0.1293"/> <!-- Converted from 0.285 lb to kg -->
        <inertia 
          ixx="1.764e-04" ixy="-2.119e-08" ixz="-8.423e-06"
          iyy="1.867e-04" iyz="-8.423e-09" izz="5.007e-04"/>
      </inertial>
    </link>
    <link name="${prefix}_link2_p2">
      <visual>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/link2p2.stl"
                scale="1 1 1"/>
        </geometry>
        <material name="${prefix}_link2_p2_yellow">
          <color rgba="0.980 0.714 0.004 1.0"/>
        </material>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/link2p2.stl"
                scale="1 1 1"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="-0.1733 0 0.00907" rpy="0 0 0"/>
        <mass value="0.0558"/> <!-- Converted from 0.123 lb to kg -->
        <inertia 
          ixx="6.069e-05" ixy="2.948e-13" ixz="1.421e-05"
          iyy="8.219e-05" iyz="-1.754e-13" izz="1.873e-04"/>
      </inertial>
    </link>
    <link name="${prefix}_link2_p3">
      <visual>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/link2p3.stl"
                scale="1 1 1"/>
        </geometry>
        <material name="${prefix}_link2_p3_yellow">
          <color rgba="0.980 0.714 0.004 1.0"/>
        </material>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/link2p3.stl"
                scale="1 1 1"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="0 0 -0.017123" rpy="0 0 0"/>
        <mass value="0.01089"/> <!-- Converted from 0.024 lb to kg -->
        <inertia 
          ixx="1.505e-06" ixy="0" ixz="0"
          iyy="1.505e-06" iyz="0" izz="3.393e-07"/>
      </inertial>
    </link>
    <joint name="${prefix}_link2_p1_to_p2" type="fixed">
      <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0"/>
      <parent link="${prefix}_link2_p1"/>
      <child link="${prefix}_link2_p2"/>
    </joint>
    <joint name="${prefix}_link2_p2_to_p3" type="fixed">
      <origin xyz="-220 0.0 6" rpy="0.0 ${pi/2} 0.0"/>
      <parent link="${prefix}_link2_p2"/>
      <child link="${prefix}_link2_p3"/>
    </joint>
    <link name="${prefix}_pusher_servo_mount">
      <visual>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/pusher_servo_mount.stl"
                scale="1 1 1"/>
        </geometry>
        <material name="${prefix}_pusher_servo_mount_yellow">
          <color rgba="0.980 0.714 0.004 1.0"/>
        </material>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/pusher_servo_mount.stl"
                scale="1 1 1"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="0 0 0.00509" rpy="0 0 0"/>
        <mass value="0.02676"/> <!-- Converted from 0.059 lb to kg -->
        <inertia 
          ixx="4.583e-06" ixy="-2.610e-08" ixz="0"
          iyy="1.544e-05" iyz="0" izz="1.939e-05"/>
      </inertial>
    </link>

    <joint name="${prefix}_pusher_servo_mount_to_link2" type="fixed">
      <origin xyz="-147 0.0 12" rpy="0.0 0.0 ${pi/2}"/>
      <parent link="${prefix}_link2_p2"/>
      <child link="${prefix}_pusher_servo_mount"/>
    </joint>

    <link name="${prefix}_pusher_servo">
      <visual>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/non_printed/pusher_servo.stl"
                scale="1 1 1"/>
        </geometry>
        <material name="${prefix}_pusher_servo_blue">
          <color rgba="0.043 0.216 0.404 1.0"/>
        </material>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/non_printed/pusher_servo.stl"
                scale="1 1 1"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="2.7e-5 0 2.02e-4" rpy="0 0 0"/>
        <mass value="0.2577"/> <!-- Converted from 0.568 lb to kg -->
        <inertia 
          ixx="6.3523e-05" ixy="0" ixz="-1.7854e-07"
          iyy="1.3415e-04" iyz="0" izz="1.1411e-04"/>
      </inertial>
    </link>

    <joint name="${prefix}_pusher_servo_to_mount" type="fixed">
      <origin xyz="10 -0.0 9.6" rpy="0.0 0.0 ${-pi/2}"/>
      <parent link="${prefix}_pusher_servo_mount"/>
      <child link="${prefix}_pusher_servo"/>
    </joint>

    <!-- link1 -->
    <link name="servo_${prefix}_link1">
      <visual>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/non_printed/60_kg_servo.stl"
                scale="1 1 1"/>
        </geometry>
        <material name="servo_${prefix}_link1_blue">
          <color rgba="0.043 0.216 0.404 1.0"/>
        </material>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/non_printed/60_kg_servo.stl"
                scale="1 1 1"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="2.7e-5 0 2.02e-4" rpy="0 0 0"/>
        <mass value="0.2577"/> <!-- Converted from 0.568 lb to kg -->
        <inertia 
          ixx="6.3523e-05" ixy="0" ixz="-1.7854e-07"
          iyy="1.3415e-04" iyz="0" izz="1.1411e-04"/>
      </inertial>
    </link>
    <link name="servo_mount_${prefix}_link1">
      <visual>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/servo_mount_slotted_60kg.stl"
                scale="1 1 1"/>
        </geometry>
        <material name="servo_mount_${prefix}_link1_blue">
          <color rgba="0.231 0.380 0.706 1.0"/>
        </material>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/servo_mount_slotted_60kg.stl"
                scale="1 1 1"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="-8.34e-7 -0.003997 0.010335" rpy="0 0 0"/>
        <mass value="0.0885"/> <!-- Converted from 0.195 lb to kg -->
        <inertia 
          ixx="8.314e-05" ixy="4.975e-08" ixz="4.666e-09"
          iyy="2.774e-05" iyz="1.256e-06" izz="8.654e-05"/>
      </inertial>
    </link>

    <joint name="${prefix}_link1_servo_to_mount" type="fixed">
      <origin xyz="0.0 0.0 27.8" rpy="0.0 0.0 ${pi/2}"/>
      <parent link="servo_mount_${prefix}_link1"/>
      <child link="servo_${prefix}_link1"/>
    </joint>

    <link name="${prefix}_link1">
      <visual>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/link1.stl"
                scale="1 1 1"/>
        </geometry>
        <material name="${prefix}_link1_blue">
          <color rgba="0.231 0.380 0.706 1.0"/>
        </material>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/link1.stl"
                scale="1 1 1"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="-0.0416 0.000229 0.00599" rpy="0 0 0"/>
        <mass value="0.0685"/> <!-- Converted from 0.151 lb to kg -->
        <inertia 
          ixx="8.657e-05" ixy="5.807e-07" ixz="-1.833e-13"
          iyy="3.632e-05" iyz="1.345e-14" izz="1.147e-04"/>
      </inertial>
    </link>

    <joint name="${prefix}_link1_to_servo" type="fixed">
      <origin xyz="-123 -31 6.5" rpy="0.0 ${pi/2} ${pi/2}"/>
      <parent link="${prefix}_link1"/>
      <child link="servo_mount_${prefix}_link1"/>
    </joint>

    <!-- horn -->
    <link name="${prefix}_horn_sleeve">
      <visual>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/horn_sleeve.stl"
                scale="1 1 1"/>
        </geometry>
        <material name="${prefix}_horn_sleeve_yellow">
          <color rgba="0.980 0.714 0.004 1.0"/>
        </material>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/horn_sleeve.stl"
                scale="1 1 1"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="0.0105 0 0.0032" rpy="0 0 0"/>
        <mass value="0.00136"/> <!-- Converted from 0.003 lb to kg -->
        <inertia 
          ixx="2.231e-08" ixy="0" ixz="3.528e-09"
          iyy="6.996e-08" iyz="0" izz="7.931e-08"/>
      </inertial>
    </link>
    <link name="${prefix}_actuator_arm">
      <visual>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/actuator_arm.stl"
                scale="1 1 1"/>
        </geometry>
        <material name="${prefix}_actuator_arm_yellow">
          <color rgba="0.980 0.714 0.004 1.0"/>
        </material>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/actuator_arm.stl"
                scale="1 1 1"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="0 -0.00246 -0.02169" rpy="0 0 0"/>
        <mass value="0.00227"/> <!-- Converted from 0.005 lb to kg -->
        <inertia 
          ixx="2.904e-07" ixy="0" ixz="0"
          iyy="2.904e-07" iyz="-1.516e-09" izz="1.669e-08"/>
      </inertial>
    </link>
    <link name="${prefix}_pusher_servo_horn">
      <visual>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/non_printed/pusher_servo_horn.stl"
                scale="1 1 1"/>
        </geometry>
        <material name="${prefix}_pusher_servo_horn_black">
          <color rgba="0.0 0.0 0.0 1.0"/>
        </material>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/non_printed/pusher_servo_horn.stl"
                scale="1 1 1"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="0 0.000381 0.000991" rpy="0 0 0"/>
        <mass value="0.000907"/> <!-- Converted from 0.002 lb to kg -->
        <inertia 
          ixx="4.566e-08" ixy="0" ixz="0"
          iyy="7.847e-09" iyz="0" izz="5.278e-08"/>
      </inertial>
    </link>
    <link name="${prefix}_sliding_cylinder">
      <visual>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/sliding_cylinder.stl"
                scale="1 1 1"/>
        </geometry>
        <material name="${prefix}_sliding_cylinder_blue">
          <color rgba="0.231 0.380 0.706 1.0"/>
        </material>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/legs/sliding_cylinder.stl"
                scale="1 1 1"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="1.958e-9 -0.01674 2.54e-5" rpy="0 0 0"/>
        <mass value="0.00998"/> <!-- Converted from 0.022 lb to kg -->
        <inertia 
          ixx="1.747e-06" ixy="-1.879e-10" ixz="-4.794e-09"
          iyy="2.903e-07" iyz="-1.288e-09" izz="1.747e-06"/>
      </inertial>
    </link>
    <link name="${prefix}_wheels">
      <visual>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/non_printed/metal_bearing.stl"
                scale="1 1 1"/>
        </geometry>
        <material name="${prefix}_wheels_silver">
          <color rgba="0.9176 0.9176 0.9176 1.0"/>
        </material>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/non_printed/metal_bearing.stl"
                scale="1 1 1"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="0 0.01198 0" rpy="0 0 0"/>
        <mass value="0.0957"/> <!-- Converted from 0.211 lb to kg -->
        <inertia 
          ixx="1.629e-05" ixy="0" ixz="0"
          iyy="1.979e-05" iyz="0" izz="1.629e-05"/>
      </inertial>
    </link>
    

    <joint name="${prefix}_servo_to_horn" type="revolute">
      <origin xyz="7.5 -10 20" rpy="0.0 0.0 ${pi/2}"/>
      <parent link="${prefix}_pusher_servo"/>
      <child link="${prefix}_pusher_servo_horn"/>
      <axis xyz="0.0 0.0 1.0"/>
      <limit lower="${-pi/2}" upper="${pi/2}" effort="50.0" velocity="1.0"/>
    </joint>
    <joint name="${prefix}_servo_horn_to_sleeve" type="fixed">
      <origin xyz="-0.0 0.0 5" rpy="${pi} 0.0 ${pi/2}"/>
      <parent link="${prefix}_pusher_servo_horn"/>
      <child link="${prefix}_horn_sleeve"/>
    </joint>
    <joint name="${prefix}_sleeve_to_arm" type="continuous">
      <origin xyz="21.2344 -0.0 003.9878" rpy="${-pi/2} 0.0 ${pi/2}"/>
      <parent link="${prefix}_horn_sleeve"/>
      <child link="${prefix}_actuator_arm"/>
      <axis xyz="0.0 1.0 0.0"/>
    </joint>


    <joint name="${prefix}_cylinder_to_arm" type="continuous">
      <origin xyz="-0.0 -2.7 -46" rpy="${pi/2} 0.0 0.0"/>
      <parent link="${prefix}_actuator_arm"/>
      <child link="${prefix}_sliding_cylinder"/>
      <axis xyz="0.0 0.0 1.0"/>
    </joint>
    <joint name="${prefix}_cylinder_to_wheels" type="fixed">
      <origin xyz="-0.0 -40.5 -0.0" rpy="0 0.0 ${pi}"/>
      <parent link="${prefix}_sliding_cylinder"/>
      <child link="${prefix}_wheels"/>
    </joint>

    <!-- joining link1 and link2 -->
    <link name="${prefix}_servo_horn">
      <visual>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/non_printed/18T_servo_horn.stl"
                scale="1 1 1"/>
        </geometry>
        <material name="${prefix}_servo_horn_purple">
          <color rgba="0.490 0.086 0.557 1.0"/>
        </material>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://${mesh_pkg}/meshes/non_printed/18T_servo_horn.stl"
                scale="1 1 1"/>
        </geometry>
      </collision>
      <inertial>
        <origin xyz="0 -0.0105 0.002" rpy="0 0 0"/>
        <mass value="0.0059"/> <!-- Converted from 0.013 lb to kg -->
        <inertia 
          ixx="8.7107e-07" ixy="0" ixz="0"
          iyy="1.0047e-07" iyz="0" izz="8.7107e-07"/>
      </inertial>
    </link>

    <joint name="${prefix}_link1_to_joint" type="revolute">
      <origin xyz="19 -0.0 24.5" rpy="0 0 ${pi/2 - 0.27925268}"/>
      <parent link="servo_${prefix}_link1"/>
      <child link="${prefix}_servo_horn"/>
      <axis xyz="0 0 1"/>
      <limit effort="10" velocity="1" lower="-2.356" upper="2.356"/>
    </joint>
    <joint name="${prefix}_joint_to_link2" type="fixed">
      <origin xyz="5 5 -28" rpy="${pi/2} ${pi} ${-pi/2}"/>
      <parent link="${prefix}_servo_horn"/>
      <child link="${prefix}_link2_p1"/>
    </joint>

    <!-- joining to the base -->
    <joint name="${prefix}_link1_to_frame" type="fixed">
      <origin xyz="5 5 -28" rpy="${pi/2} ${pi} ${-pi/2}"/>
      <parent link="${parent_link}"/>
      <child link="${prefix}_link1"/>
    </joint>

  </xacro:macro>

</robot>